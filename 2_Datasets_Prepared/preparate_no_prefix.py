import pandas as pd
import time

def main():
# lendo o arquivo csv
    start_read = time.time()
    print("Lendo o arquivo CSV...")
    df = pd.read_csv("Malwares_atuais.csv")
    end_read = time.time()
    
    print("Finalizado!!!\nTempo de leitura:", (end_read - start_read), "segundos")

    # retirar prefixos do nome das colunas (e.g., "Permission :: ", "Intent :: ")
    
    start_treatment = time.time()
    print("\nRetirando prefixos do nome das colunas...")
    for col in df:
        if ":: " in col:
            split = str(col).split(":: ")[1]
            df.rename(columns={col: split}, inplace=True)
    end_treatment = time.time()
    
    print("\nFinalizado!!!\nTempo de tratamento de prefixos:", (end_treatment - start_treatment), "segundos")
    
    start_exportation = time.time()
    print("\nGerando arquivo CSV...")
    # exportar CSV
    df.to_csv("Malwares_atuais_no_prefix.csv", index=False)
    end_exportation = time.time()
    
    print("\nFinalizado!!!\nTempo de geração de CSV:", (end_exportation - start_exportation), "segundos")

main()